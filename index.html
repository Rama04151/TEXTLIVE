<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Live Text Rama</title>

  <!-- Library stabil -->
  <script src="https://cdn.jsdelivr.net/npm/yjs@13.6.9/dist/yjs.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/y-webrtc@10.2.5/dist/y-webrtc.js"></script>

  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f5f5f5;
    }
    textarea {
      width: 100%;
      height: 250px;
      font-size: 16px;
      padding: 10px;
    }
  </style>
</head>
<body>

<h2>Live Text (Tanpa Login)</h2>
<p>Buka link ini di 2 device â†’ ketik â†’ langsung terbaca</p>

<textarea id="editor" placeholder="Ketik di sini..."></textarea>

<script>
  // Buat dokumen Yjs
  const ydoc = new Y.Doc();

  // ðŸ”´ INI SCRIPT YANG KURANG TADI (SIGNALING SERVER)
  const provider = new Y.WebrtcProvider(
    'ruang-text-1', // nama room (bebas tapi harus sama)
    ydoc,
    {
      signaling: ['wss://signaling.yjs.dev']
    }
  );

  // Debug status koneksi
  provider.on('status', event => {
    console.log('STATUS:', event.status);
  });

  const ytext = ydoc.getText('shared-text');
  const textarea = document.getElementById('editor');

  // Update tampilan kalau ada perubahan dari device lain
  ytext.observe(() => {
    if (textarea.value !== ytext.toString()) {
      textarea.value = ytext.toString();
    }
  });

  // Update teks saat mengetik
  textarea.addEventListener('input', () => {
    ydoc.transact(() => {
      ytext.delete(0, ytext.length);
      ytext.insert(0, textarea.value);
    });
  });
</script>

</body>
</html>
